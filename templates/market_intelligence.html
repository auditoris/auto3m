{% extends "base.html" %}

{% block content %}
<h1 class="mb-4">ğŸ“ˆ ì‹œì¥ ì¸í…”ë¦¬ì „ìŠ¤ ë¡œë´‡</h1>

<div class="alert alert-info" role="alert">
    í˜„ì¬ ì‹œì¥ ê°ì„±: <strong>{{ robot_status.current_market_sentiment }}</strong> (ìë™/ìˆ˜ë™ ì‹¤í–‰ í†µí•©)
</div>

<div class="card mb-4">
    <div class="card-header">
        ë¡œë´‡ ìƒíƒœ
    </div>
    <div class="card-body">
        <p class="card-text"><strong>ìƒíƒœ:</strong> <span class="badge bg-{{ 'success' if robot_status.mi_status == 'ì™„ë£Œ' else 'warning' if 'ì‹¤í–‰ ì¤‘' in robot_status.mi_status else 'danger' if 'ì˜¤ë¥˜' in robot_status.mi_status else 'info' }}">{{ robot_status.mi_status }}</span></p>
        <p class="card-text"><strong>ë§ˆì§€ë§‰ ì‹¤í–‰:</strong> {{ robot_status.mi_last_run }}</p>
        <p class="card-text"><strong>ë§ˆì§€ë§‰ ê°ì„±:</strong> {{ robot_status.mi_last_sentiment }}</p>
    </div>
</div>

<form method="POST" action="{{ url_for('market_intelligence') }}" class="mb-4 p-4 border rounded shadow-sm bg-light">
    <h5 class="mb-3">ë‰´ìŠ¤ ë°ì´í„° ìˆ˜ì§‘ & ê°ì„± ë¶„ì„ (ìˆ˜ë™ ì‹¤í–‰)</h5>
    <div class="mb-3">
        <label for="keyword" class="form-label">íƒìƒ‰í•  í‚¤ì›Œë“œ (ìƒëµ ì‹œ ê¸°ë³¸ê°’ ì¤‘ ëœë¤ ì„ íƒ):</label>
        <input type="text" class="form-control" id="keyword" name="keyword" placeholder="ì˜ˆ: AI ë°˜ë„ì²´">
    </div>
    <div class="mb-3">
        <label for="time_period" class="form-label">ê²€ìƒ‰ ê¸°ê°„ (ì˜ˆ: ìµœê·¼ 1ì¼, ìµœê·¼ 1ì£¼, ìµœê·¼ 1ê°œì›” / ìƒëµ ì‹œ 'ìµœê·¼ 1ì£¼'):</label>
        <input type="text" class="form-control" id="time_period" name="time_period" value="ìµœê·¼ 1ì£¼">
    </div>
    <button type="submit" class="btn btn-primary">ë‰´ìŠ¤ ìˆ˜ì§‘ ë° ë¶„ì„ ì‹œì‘</button>
</form>

{% if sentiment_graph_url %}
<div class="card mb-4">
    <div class="card-header">
        ë‰´ìŠ¤ ê°ì„± ë¶„í¬
    </div>
    <div class="card-body text-center">
        <img src="data:image/png;base64,{{ sentiment_graph_url }}" class="img-fluid" alt="Sentiment Distribution Graph">
    </div>
</div>
{% endif %}

<div class="card mb-4">
    <div class="card-header">
        ìˆ˜ì§‘ëœ ìµœì‹  ë‰´ìŠ¤ ë°ì´í„° (ìµœëŒ€ 20ê±´)
    </div>
    <div class="card-body">
        {% if news_data %}
            {{ news_data | safe }}
        {% else %}
            <p class="text-muted">ìˆ˜ì§‘ëœ ë‰´ìŠ¤ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ìœ„ í¼ì„ í†µí•´ ìƒˆë¡œìš´ ë‰´ìŠ¤ë¥¼ ìˆ˜ì§‘í•´ì£¼ì„¸ìš”.</p>
        {% endif %}
    </div>
</div>

{% endblock %}